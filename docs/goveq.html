<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Building: “expert” mode" href="build_expert.html" /><link rel="prev" title="SHeAr Waves (SHAW) Simulator" href="index.html" />

    <meta name="generator" content="sphinx-4.2.0, furo 2021.10.09"/>
        <title>Governing equations - SHAW 0.1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=0254c309f5cadf746f1a613e7677379ac9c8cdcd" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=16fb25fabf47304eee183a5e9af80b1ba98259b1" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">SHAW 0.1.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">SHAW 0.1.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Governing equations</a></li>
<li class="toctree-l1"><a class="reference internal" href="#discretization">Discretization</a></li>
<li class="toctree-l1"><a class="reference internal" href="build_expert.html">Building: “expert” mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="build_stepbystep.html">Building: step-by-step</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="inputfile.html">Input File</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="inputfile_description.html">General Section</a></li>
<li class="toctree-l2"><a class="reference internal" href="inputfile_description.html#io-section">IO Section</a></li>
<li class="toctree-l2"><a class="reference internal" href="inputfile_description.html#source-forcing-section">Source/forcing Section</a></li>
<li class="toctree-l2"><a class="reference internal" href="inputfile_description.html#material-model-section">Material Model Section</a></li>
<li class="toctree-l2"><a class="reference internal" href="inputfile_template.html">Template</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="demos.html">End-to-end Demos</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="demo1.html">Demo 1</a></li>
<li class="toctree-l2"><a class="reference internal" href="demo2.html">Demo 2</a></li>
<li class="toctree-l2"><a class="reference internal" href="demo3.html">Demo 3</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="performance.html">Performance</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Pressio/SHAW">GitHub Repo</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/Pressio/SHAW/issues">Open an issue/feature req.</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <div class="section" id="governing-equations">
<h1>Governing equations<a class="headerlink" href="#governing-equations" title="Permalink to this headline">¶</a></h1>
<p>This code simulates the evolution of elastic seismic shear waves in an axisymmetric domain.</p>
<p>Assuming the target body/planet (e.g. Earth) can be approximated as a sphere,
we adopt a spherical coordinate system as shown in the figure below:</p>
<a class="reference internal image-reference" href="_images/sc.svg"><img alt="Alternative text" class="align-center" src="_images/sc.svg" width="35%"/></a>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>In the axisymmetric approximation, one assumes that fields/quantities
do not vary along <span class="math notranslate nohighlight">\(\phi\)</span>, implying that all the derivatives
with respect to <span class="math notranslate nohighlight">\(\phi\)</span> can be dropped.</p>
</div>
<p>With this assumption, the set of equations governing the time evolution
of elastic waves in the velocity-stress formulation can be written as:</p>
<div class="math-wrapper"><div class="math notranslate nohighlight">
\[\rho \frac{\partial v}{\partial t} =
\frac{\partial \sigma_{r\phi}}{\partial r}
+ \frac{\partial \sigma_{\theta\phi}}{r \partial \theta}
+ \frac{3}{r} \Big(\sigma_{r\phi}
+ 2 \sigma_{\theta\phi} \cot{\theta} \Big) + f\]</div></div>
<div class="math-wrapper"><div class="math notranslate nohighlight">
\[\frac{\partial \sigma_{r\phi}}{\partial t} =
G \left( \frac{\partial v}{\partial r} - \frac{1}{r} v \right)\]</div></div>
<div class="math-wrapper"><div class="math notranslate nohighlight">
\[\frac{\partial \sigma_{\theta\phi}}{\partial t} =
G \left( \frac{1}{r} \frac{\partial v}{\partial \theta}
- \frac{\cot{\theta}}{r} v \right)\]</div></div>
<p>where:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(t\)</span> represents time</p></li>
<li><p><span class="math notranslate nohighlight">\(r \in [0, r_{surface}]\)</span> is the radial distance from origin to the surface of the body</p></li>
<li><p><span class="math notranslate nohighlight">\(\theta \in [0, \pi]\)</span> is the polar angle</p></li>
<li><p><span class="math notranslate nohighlight">\(\rho(r, \theta)\)</span> is the density</p></li>
<li><p><span class="math notranslate nohighlight">\(v(r, \theta, t)\)</span> is the velocity (for simplicity we drop the subscript,
but it is intended to be the <span class="math notranslate nohighlight">\(v_{\phi}\)</span> velocity component)</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma_{r\phi}(r, \theta, t)\)</span> and <span class="math notranslate nohighlight">\(\sigma_{\theta\phi}(r, \theta, t)\)</span>
are the two components of the stress tensor remaining after the axisymmetric approximation</p></li>
<li><p><span class="math notranslate nohighlight">\(f(r, \theta,t)\)</span> is the forcing term</p></li>
<li><p><span class="math notranslate nohighlight">\(G(r, \theta) = v_s^2(r, \theta) \rho(r, \theta)\)</span> is the shear modulus
and <span class="math notranslate nohighlight">\(v_s\)</span> being the shear wave velocity.</p></li>
</ul>
<p>In practice, the axisymmetric approximation means that one solves the
above governing equations over a <em>circular sector/block arc</em>.
Such a formulation is referred to as 2.5-dimensional because it involves
a 2-dimensional spatial domain (a circular sector of the Earth)
but models point sources with correct 3-dimensional spreading {cite}.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We assume both the density and shear modulus to only depend on the spatial coordinates.</p>
</div>
</div>
<div class="section" id="discretization">
<span id="id1"></span><h1>Discretization<a class="headerlink" href="#discretization" title="Permalink to this headline">¶</a></h1>
<p>Shear waves cannot propagate in liquids.
Therefore, when modeling the Earth, the system of equations above is not
applicable to the core region of the Earth, and is solved in the region
bounded between the core-mantle boundary (CMB) located at <span class="math notranslate nohighlight">\(r_{cmb} = 3,480\)</span> km
and the Earth surface located at <span class="math notranslate nohighlight">\(r_{earth} = 6,371\)</span> km.
When modeling a body that is not the Earth, one needs to use proper domain bounds.
Note, however, that the code <em>always</em> assumes the domain NOT to include the
singularity at the origin, which yields substantial simplifications.</p>
<p>The 2D spatial domain is discretized using a staggered grid.
Staggered grids are typical for seismic modeling and wave problems in general.
We use a second-order centered finite-difference method for the spatial operators.
Directly at the symmetry axis, i.e., <span class="math notranslate nohighlight">\(\theta = 0, \pi\)</span>, the velocity
is set to zero since it undefined here due to the cotangent term in its governing equation.
This implies that at the symmetry axis the stress <span class="math notranslate nohighlight">\(\sigma_{r,\phi}\)</span> is also zero.
At the core-mantle boundary and earth surface we impose a free surface boundary
condition (i.e., waves fully reflect), by setting the zero-stress condition
<span class="math notranslate nohighlight">\(\sigma_{r_{cmb},\phi} = \sigma_{r_{earth},\phi} = 0\)</span>.
Note that this condition on the stress directly defines the velocity
at the core-mantle boundary and earth surface and, therefore,
no boundary condition on the velocity itself must be set there.
We remark that, differently than (cite), we do not rely on ghost
points to impose boundary conditions, but account for the boundary
conditions directly when assembling the system matrix.</p>
<p>The figure below shows the grid when modeling the Earth: the computational
domain extends from the surface to the core-mantle boundary, excluding the liquid core.</p>
<div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="_images/mesh.png"><img alt="_images/mesh.png" src="_images/mesh.png" style="width: 450px;"/></a>
<p class="caption"><span class="caption-text">Schematic of the axi-symmetric domain for the Earth and staggered grid used for its discretization.</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
</div>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="build_expert.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Building: “expert” mode</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2021, National Technology &amp; Engineering Solutions of Sandia, LLC (NTESS) |
            Last updated on Dec 04, 2021. |
            Built with <a href="https://www.sphinx-doc.org/">Sphinx</a>
              and
              <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
              <a href="https://github.com/pradyunsg/furo">Furo theme</a>. |
            <a class="muted-link" href="_sources/goveq.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Governing equations</a></li>
<li><a class="reference internal" href="#discretization">Discretization</a></li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/main.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>